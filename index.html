<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>NextGen Inventory</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@tailwindcss/forms"></script>
  <script src="https://unpkg.com/feather-icons"></script>
  <style>
    body {
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      font-family: 'Inter', sans-serif;
    }
    .glass {
      backdrop-filter: blur(16px) saturate(180%);
      -webkit-backdrop-filter: blur(16px) saturate(180%);
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 1rem;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
  </style>
</head>
<body class="flex items-center justify-center min-h-screen text-white">

  <div id="app" class="glass w-full max-w-lg p-8 shadow-xl">
    <!-- Login -->
    <div id="loginPage">
      <h1 class="text-3xl font-bold text-center mb-6">üîê Inventory Login</h1>
      <input id="username" type="text" placeholder="Username" class="w-full mb-3 p-3 rounded bg-gray-800 text-white focus:outline-none">
      <input id="password" type="password" placeholder="Password" class="w-full mb-3 p-3 rounded bg-gray-800 text-white focus:outline-none">
      <button onclick="login()" class="w-full py-3 rounded bg-blue-500 hover:bg-blue-600 transition font-semibold">Login</button>
      <p id="loginError" class="text-red-400 text-center mt-3 hidden">Invalid login</p>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="hidden">
      <h2 class="text-2xl font-bold mb-4">üì¶ Inventory Dashboard</h2>
      <div class="space-y-3">
        <button onclick="loadItems()" class="w-full py-3 rounded bg-green-500 hover:bg-green-600 transition">Get Items</button>
        <button onclick="showRequestForm()" class="w-full py-3 rounded bg-yellow-500 hover:bg-yellow-600 transition">Submit Request</button>
        <button onclick="listPending()" class="w-full py-3 rounded bg-purple-500 hover:bg-purple-600 transition">Admin: Pending Requests</button>
        <button onclick="logout()" class="w-full py-3 rounded bg-gray-700 hover:bg-gray-800 transition">Logout</button>
      </div>
      <div id="output" class="mt-6 text-sm"></div>
    </div>
  </div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxSWzhdYjp7YkvMcNW7_MBf-tAHhjtVzAG0WLjLovUXdlo8gNILymIccbRtKhJCNwJi/exec"; // Replace with Apps Script Web App URL
let currentUser=null;

// --- API helpers
async function get(url){
  const r=await fetch(API_URL+url);
  return await r.json();
}
async function post(data){
  const r=await fetch(API_URL,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(data)
  });
  return await r.json();
}

// --- Auth
async function login(){
  const u=document.getElementById("username").value.trim();
  const p=document.getElementById("password").value.trim();
  const res=await post({action:"login",username:u,password:p});
  if(res.success){
    currentUser={u,p,isAdmin:res.isAdmin};
    document.getElementById("loginPage").classList.add("hidden");
    document.getElementById("dashboard").classList.remove("hidden");
  }else{
    document.getElementById("loginError").classList.remove("hidden");
  }
}
function logout(){
  currentUser=null;
  document.getElementById("dashboard").classList.add("hidden");
  document.getElementById("loginPage").classList.remove("hidden");
}

// --- Inventory
async function loadItems(){
  const res=await get("?action=getItems");
  showOutput(res);
}
async function showRequestForm(){
  showOutput({form:"Coming soon: request form UI"});
}
async function listPending(){
  if(!currentUser?.isAdmin){showOutput({error:"Not admin"});return;}
  const res=await post({action:"listPending",username:currentUser.u,password:currentUser.p});
  showOutput(res);
}

// --- Utils
function showOutput(data){
  document.getElementById("output").innerText=JSON.stringify(data,null,2);
}
</script>
</body>
</html>
